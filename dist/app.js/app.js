"use strict";var startinputEle=document.querySelectorAll("input")[0],destinputEle=document.querySelectorAll("input")[1],planbtnEle=document.querySelector(".plan-trip"),originresuleEle=document.querySelector(".origins"),origin_liEle=document.querySelectorAll(".origins li"),destresultEle=document.querySelector(".destinations"),mytripEle=document.querySelector(".my-trip"),mapboxToken="pk.eyJ1IjoiYXNobGV5a2VlIiwiYSI6ImNrYTV5bnU1bDAyNHYyeW9meWplZGU3MW4ifQ.douk1UHj2ibkR2-TzmCWpg",winnipegApi="Ih1V6TNl5DTR9QitZx",originGeo={},destGeo={};function searchOrign(t){fetch("https://api.mapbox.com/geocoding/v5/mapbox.places/".concat(t,".json?access_token=").concat(mapboxToken,"&limit=10&bbox=-97.325875,49.766204,-96.953987,49.99275")).then(function(t){if(t.ok)return t.json();throw new Error("Houston,  we have a problem.")}).then(function(t){insertaddress("origin",t.features)})}function searchDest(t){fetch("https://api.mapbox.com/geocoding/v5/mapbox.places/".concat(t,".json?access_token=").concat(mapboxToken,"&limit=10&bbox=-97.325875,49.766204,-96.953987,49.99275")).then(function(t){if(t.ok)return t.json();throw new Error("Houston,  we have a problem.")}).then(function(t){insertaddress("destination",t.features)})}function insertaddress(t,e){"origin"===t&&(originresuleEle.innerHTML=""),"destination"===t&&(destresultEle.innerHTML="");var n="";e.forEach(function(t){var e=t.place_name.split(",");n+='\n\n        <li data-long="'.concat(t.geometry.coordinates[0],'" data-lat="').concat(t.geometry.coordinates[1],'" class="false">\n          <div class="name">').concat(e[0],"</div>\n          <div>").concat(e[1],"</div>\n        </li>\n    ")}),"origin"===t&&(originresuleEle.innerHTML=n),"destination"===t&&(destresultEle.innerHTML=n)}function plantrip(t,e){fetch("https://api.winnipegtransit.com/v3/trip-planner.json?origin=geo/".concat(t.latitude,",").concat(t.longtitude,"&api-key=").concat(winnipegApi,"&destination=geo/").concat(e.latitude,",").concat(e.longtitude)).then(function(t){if(t.ok)return t.json();throw new Error("Houston,  we have a problem.")}).then(function(t){plantripWrite(t.plans[0].segments)})}function plantripWrite(t){var e="",n="",o="";t.forEach(function(t){"walk"===t.type&&(e="fas fa-walking",n=t.to.destination?"Walk for ".concat(t.times.durations.total," minutes to destination"):"Walk for ".concat(t.times.durations.total," minutes to stop #").concat(t.to.stop.key,"-  ").concat(t.to.stop.name," "),o+="<li><i class='".concat(e,'\' aria-hidden="true"></i>').concat(n,"</li>")),"ride"===t.type&&(e="fas fa-bus",n="Ride the ".concat(t.route.name," for ").concat(t.times.durations.total),o+="<li><i class='".concat(e,'\' aria-hidden="true"></i>').concat(n,"</li>")),"transfer"===t.type&&(e="fas fa-ticket-alt",n="Transfer from stop #".concat(t.from.stop.key,"- ").concat(t.from.stop.name,"$ to #").concat(t.to.stop.key,"-").concat(t.to.stop.name),o+="<li><i class='".concat(e,'\' aria-hidden="true"></i>').concat(n,"</li>"))}),mytripEle.innerHTML=o}startinputEle.addEventListener("keydown",function(t){13==t.keyCode&&(t.cancelBubble=!0,t.returnValue=!1,searchOrign(startinputEle.value))}),destinputEle.addEventListener("keydown",function(t){13==t.keyCode&&(t.cancelBubble=!0,t.returnValue=!1,searchDest(destinputEle.value))}),originresuleEle.addEventListener("click",function(t){document.querySelectorAll(".origins .selected").forEach(function(t){t.className=!1}),"false"===t.target.closest("li").className&&(t.target.closest("li").className="selected",originGeo.latitude=t.target.closest("li").getAttribute("data-lat"),originGeo.longtitude=t.target.closest("li").getAttribute("data-long"))}),destresultEle.addEventListener("click",function(t){document.querySelectorAll(".destinations .selected").forEach(function(t){t.className=!1}),"false"===t.target.closest("li").className&&(t.target.closest("li").className="selected",destGeo.latitude=t.target.closest("li").getAttribute("data-lat"),destGeo.longtitude=t.target.closest("li").getAttribute("data-long"))}),planbtnEle.onclick=function(){originGeo.latitude!==destGeo.latitude&&originGeo.longtitude!==destGeo.longtitude&&plantrip(originGeo,destGeo)};